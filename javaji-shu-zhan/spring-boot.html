<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SpringBoot 基础篇 | PYY在线笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/study/img/logo.png">
    <meta name="description" content="PYY在线笔记">
    
    <link rel="preload" href="/study/assets/css/0.styles.f503b9f0.css" as="style"><link rel="preload" href="/study/assets/js/app.dc60e210.js" as="script"><link rel="preload" href="/study/assets/js/6.fceef279.js" as="script"><link rel="preload" href="/study/assets/js/7.e9fa99bf.js" as="script"><link rel="prefetch" href="/study/assets/js/10.7ed69d34.js"><link rel="prefetch" href="/study/assets/js/11.9448c32e.js"><link rel="prefetch" href="/study/assets/js/12.86c493c7.js"><link rel="prefetch" href="/study/assets/js/13.9ed58975.js"><link rel="prefetch" href="/study/assets/js/14.48e59348.js"><link rel="prefetch" href="/study/assets/js/15.b5bdf29c.js"><link rel="prefetch" href="/study/assets/js/16.7e65e129.js"><link rel="prefetch" href="/study/assets/js/17.d21d2357.js"><link rel="prefetch" href="/study/assets/js/18.ff6a09ec.js"><link rel="prefetch" href="/study/assets/js/19.4dd597a5.js"><link rel="prefetch" href="/study/assets/js/2.6082ecbd.js"><link rel="prefetch" href="/study/assets/js/20.13424f64.js"><link rel="prefetch" href="/study/assets/js/21.d0a93e41.js"><link rel="prefetch" href="/study/assets/js/22.3157d1d1.js"><link rel="prefetch" href="/study/assets/js/23.bf30424e.js"><link rel="prefetch" href="/study/assets/js/24.6e0cd257.js"><link rel="prefetch" href="/study/assets/js/25.85fbb512.js"><link rel="prefetch" href="/study/assets/js/26.c54e0c14.js"><link rel="prefetch" href="/study/assets/js/27.6da488a3.js"><link rel="prefetch" href="/study/assets/js/28.321038ce.js"><link rel="prefetch" href="/study/assets/js/29.3fe454c4.js"><link rel="prefetch" href="/study/assets/js/3.e7c144f8.js"><link rel="prefetch" href="/study/assets/js/30.2c2ed4ad.js"><link rel="prefetch" href="/study/assets/js/31.99fb9619.js"><link rel="prefetch" href="/study/assets/js/32.5aea4bba.js"><link rel="prefetch" href="/study/assets/js/33.8ed67f2e.js"><link rel="prefetch" href="/study/assets/js/34.4eb2a764.js"><link rel="prefetch" href="/study/assets/js/35.32c83c52.js"><link rel="prefetch" href="/study/assets/js/36.0e7c4410.js"><link rel="prefetch" href="/study/assets/js/37.029a3bab.js"><link rel="prefetch" href="/study/assets/js/38.9404c1e2.js"><link rel="prefetch" href="/study/assets/js/39.99a331b6.js"><link rel="prefetch" href="/study/assets/js/4.5e539c6c.js"><link rel="prefetch" href="/study/assets/js/40.68a12f82.js"><link rel="prefetch" href="/study/assets/js/41.f802eb8f.js"><link rel="prefetch" href="/study/assets/js/42.9353144d.js"><link rel="prefetch" href="/study/assets/js/43.58a525e4.js"><link rel="prefetch" href="/study/assets/js/44.d327c357.js"><link rel="prefetch" href="/study/assets/js/45.54dc5bdd.js"><link rel="prefetch" href="/study/assets/js/46.97eb4353.js"><link rel="prefetch" href="/study/assets/js/47.d0f5dd26.js"><link rel="prefetch" href="/study/assets/js/48.c71e0efd.js"><link rel="prefetch" href="/study/assets/js/49.c4bf96d9.js"><link rel="prefetch" href="/study/assets/js/5.49f21cfc.js"><link rel="prefetch" href="/study/assets/js/50.a9f40bc0.js"><link rel="prefetch" href="/study/assets/js/51.cb5601bb.js"><link rel="prefetch" href="/study/assets/js/52.f4b73d57.js"><link rel="prefetch" href="/study/assets/js/8.60f08f23.js"><link rel="prefetch" href="/study/assets/js/9.1ebd5ad9.js">
    <link rel="stylesheet" href="/study/assets/css/0.styles.f503b9f0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/study/" class="home-link router-link-active"><img src="/study/img/logo.png" alt="PYY在线笔记" class="logo"> <span class="site-name can-hide">PYY在线笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/study/技术方案/" class="nav-link">
  技术方案
</a></div><div class="nav-item"><a href="/study/Java技术栈/" class="nav-link">
  Java技术栈
</a></div><div class="nav-item"><a href="/study/分布式/" class="nav-link">
  分布式
</a></div><div class="nav-item"><a href="/study/大数据/" class="nav-link">
  大数据
</a></div><div class="nav-item"><a href="/study/消息队列/" class="nav-link">
  消息队列
</a></div><div class="nav-item"><a href="/study/数据结构和算法/" class="nav-link">
  数据结构和算法
</a></div><div class="nav-item"><a href="/study/k8s/" class="nav-link">
  k8s
</a></div><div class="nav-item"><a href="/study/ServiceMesh/" class="nav-link">
  ServiceMesh
</a></div><div class="nav-item"><a href="/study/DevOps/" class="nav-link">
  DevOps
</a></div><div class="nav-item"><a href="/study/总结/" class="nav-link">
  总结
</a></div><div class="nav-item"><a href="https://www.jianshu.com/u/af08f637aff8" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/study/技术方案/" class="nav-link">
  技术方案
</a></div><div class="nav-item"><a href="/study/Java技术栈/" class="nav-link">
  Java技术栈
</a></div><div class="nav-item"><a href="/study/分布式/" class="nav-link">
  分布式
</a></div><div class="nav-item"><a href="/study/大数据/" class="nav-link">
  大数据
</a></div><div class="nav-item"><a href="/study/消息队列/" class="nav-link">
  消息队列
</a></div><div class="nav-item"><a href="/study/数据结构和算法/" class="nav-link">
  数据结构和算法
</a></div><div class="nav-item"><a href="/study/k8s/" class="nav-link">
  k8s
</a></div><div class="nav-item"><a href="/study/ServiceMesh/" class="nav-link">
  ServiceMesh
</a></div><div class="nav-item"><a href="/study/DevOps/" class="nav-link">
  DevOps
</a></div><div class="nav-item"><a href="/study/总结/" class="nav-link">
  总结
</a></div><div class="nav-item"><a href="https://www.jianshu.com/u/af08f637aff8" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Dev Ops</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Java技术栈</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study/javaji-shu-zhan/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/study/javaji-shu-zhan/spring.html" class="sidebar-link">Spring注解开发</a></li><li><a href="/study/javaji-shu-zhan/spring-boot.html" aria-current="page" class="active sidebar-link">SpringBoot 基础篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#一、环境准备" class="sidebar-link">一、环境准备</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_1-1-maven-设置" class="sidebar-link">1.1 MAVEN 设置</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_1-2-idea-设置" class="sidebar-link">1.2 IDEA 设置</a></li></ul></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#二、自动装配" class="sidebar-link">二、自动装配</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_2-1-默认扫描器-basepackage" class="sidebar-link">2.1 默认扫描器 basepackage</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_2-2-源码解析" class="sidebar-link">2.2 源码解析</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_2-3-自动配置" class="sidebar-link">2.3 自动配置</a></li></ul></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#三、热部署" class="sidebar-link">三、热部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_3-1-原理" class="sidebar-link">3.1 原理</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_3-2-devtools-工具包" class="sidebar-link">3.2 devtools 工具包</a></li></ul></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#四、配置文件" class="sidebar-link">四、配置文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_4-1-配置文件位置" class="sidebar-link">4.1 配置文件位置</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_4-2-yaml" class="sidebar-link">4.2 yaml</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_4-3-属性绑定" class="sidebar-link">4.3 属性绑定</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_4-4-构造器绑定" class="sidebar-link">4.4 构造器绑定</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_4-5-第三方组件注入" class="sidebar-link">4.5 第三方组件注入</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_4-6-松散绑定" class="sidebar-link">4.6 松散绑定</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_4-7-configurationproperties-校验" class="sidebar-link">4.7 @ConfigurationProperties 校验</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_4-8-configurationproperties-vs-value" class="sidebar-link">4.8 @ConfigurationProperties vs. @Value</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_4-9-profile" class="sidebar-link">4.9 Profile</a></li></ul></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#五、java-中的-spi" class="sidebar-link">五、Java 中的 SPI</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_5-1-什么是java的spi" class="sidebar-link">5.1 什么是java的SPI</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_5-2-spi-应用场景" class="sidebar-link">5.2 SPI 应用场景</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_5-3-java-spi-规范" class="sidebar-link">5.3 Java SPI 规范</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_5-4-案例代码" class="sidebar-link">5.4 案例代码</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_5-5-总结" class="sidebar-link">5.5 总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#六、spring-boot-中的-spi-机制" class="sidebar-link">六、Spring Boot 中的 SPI 机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_5-1-spring-factories-实现原理" class="sidebar-link">5.1 Spring Factories 实现原理</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_5-2-自动配置类原理" class="sidebar-link">5.2 自动配置类原理</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_5-3-条件判断-conditional" class="sidebar-link">5.3 条件判断@Conditional</a></li></ul></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#七、spring-boot-数据源自动配置" class="sidebar-link">七、Spring Boot 数据源自动配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_7-1-数据源自动管理" class="sidebar-link">7.1 数据源自动管理</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_7-2-数据源自动配置原理" class="sidebar-link">7.2 数据源自动配置原理</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_7-3-配置-druid-数据源" class="sidebar-link">7.3 配置 Druid 数据源</a></li></ul></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#八、自定义-starter" class="sidebar-link">八、自定义 Starter</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_8-1-springboot-starter机制" class="sidebar-link">8.1 SpringBoot starter机制</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_8-2-为什么要自定义starter" class="sidebar-link">8.2 为什么要自定义starter</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_8-3-自定义starter的命名规则" class="sidebar-link">8.3 自定义starter的命名规则</a></li><li class="sidebar-sub-header"><a href="/study/javaji-shu-zhan/spring-boot.html#_8-4-实例" class="sidebar-link">8.4 实例</a></li></ul></li></ul></li><li><a href="/study/javaji-shu-zhan/spring-security-oauth2.html" class="sidebar-link">Spring Security OAuth2</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Service Mesh</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>K 8 S</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>大数据</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>总结</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>技术方案</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构和算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>消息队列</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="springboot-基础篇"><a href="#springboot-基础篇" class="header-anchor">#</a> SpringBoot 基础篇</h1> <p><a href="https://docs.spring.io/spring-boot/docs/2.4.0/reference/html/index.html" target="_blank" rel="noopener noreferrer">Spring Boot 参考文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/study/assets/img/image-20201118101525521.885a4e70.png" alt="image-20201118101525521"></p> <p>SpringBoot让创建独立的，生产环境的基于Spring的应用更加快捷简易。 大部分Spring Boot Application只要一些极简的配置，即可“一键运行”。</p> <p>Spring Boot，简单讲就是牺牲项目的自由度来减少配置的复杂度（“契约式编程”思想，SpringBoot自动配置方案的指导思想）。约定一套规则，把这些框架都自动配置集成好，从而达到“开箱即用”。同时，也支持自由配置。这就是一个非常好的方案了。</p> <p><strong>SpringBoot的特性</strong></p> <ul><li>创建独立的Spring applications</li> <li>能够使用内嵌的Tomcat, Jetty or Undertow，不需要部署war</li> <li>提供定制化的starter poms来简化maven配置（gradle相同）</li> <li>追求极致的自动配置Spring</li> <li>提供一些生产环境的特性，比如特征指标，健康检查和外部配置。</li> <li>零代码生成和零XML配置</li></ul> <p>Spring由于其繁琐的配置，一度被人认为“配置地狱”，各种XML、Annotation配置，让人眼花缭乱，而且如果出错了也很难找出原因。而Spring Boot更多的是采用Java Config的方式，对Spring进行配置。</p> <p>我们企业级软件的目标是提供稳定健壮的服务，以实现其商业价值。为了满足这些需求，服务开发者需要能够快速构建和迭代新的应用，同时应用的架构是可扩展的，便携式的，富弹性的，可以进行频繁的更新。SpringBoot正式为此而诞生。</p> <h2 id="一、环境准备"><a href="#一、环境准备" class="header-anchor">#</a> 一、环境准备</h2> <p>jdk1.8：Spring Boot 推荐jdk1.8及以上；</p> <p>maven3.x：maven 3.3以上版本；</p> <p>IntelliJIDEA2019；</p> <p>SpringBoot 2.3.0.RELEASE；</p> <h3 id="_1-1-maven-设置"><a href="#_1-1-maven-设置" class="header-anchor">#</a> 1.1 MAVEN 设置</h3> <ol><li><p>配置阿里云镜像</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirror</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>nexus-aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>central<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>Nexus aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span>http://maven.aliyun.com/nexus/content/groups/public<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirror</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>给maven 的settings.xml配置文件的profiles标签添加</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>jdk-1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activation</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activeByDefault</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activeByDefault</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jdk</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jdk</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activation</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.compilerVersion</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.compilerVersion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li></ol> <h3 id="_1-2-idea-设置"><a href="#_1-2-idea-设置" class="header-anchor">#</a> 1.2 IDEA 设置</h3> <ol><li><p>指定 JDK 环境</p> <p><img src="/study/assets/img/image-20201118105715413.07c37d05.png" alt="image-20201118105715413"></p></li> <li><p>指定MAVEN环境</p> <p><img src="/study/assets/img/image-20201118105844032.2684f757.png" alt="image-20201118105844032"></p></li></ol> <h2 id="二、自动装配"><a href="#二、自动装配" class="header-anchor">#</a> 二、自动装配</h2> <h3 id="_2-1-默认扫描器-basepackage"><a href="#_2-1-默认扫描器-basepackage" class="header-anchor">#</a> 2.1 默认扫描器 basepackage</h3> <p>springboot的主启动类所在的package就是扫描器的basepackage</p> <p>如图所示com.example.myapplication就是我们的扫描器中basepackge</p> <p><img src="/study/assets/img/image-20201118110754360.8e03e8ac.png" alt="image-20201118110754360"></p> <h3 id="_2-2-源码解析"><a href="#_2-2-源码解析" class="header-anchor">#</a> 2.2 源码解析</h3> <p>@AutoConfigurationPackage 自动配置包负责basepackge的注册</p> <p><img src="/study/assets/img/image-20201118111141502.be80f6d2.png" alt="image-20201118111141502"></p> <p>让我们进入AutoConfigurationPackages.Registrar，通过register的调用来注册basepackage的bean定义的</p> <p><img src="/study/assets/img/image-20201118111239471.504c5da5.png" alt="image-20201118111239471"></p> <p>进入到PackageImports，获得basepackge设置给packageNames</p> <p><img src="/study/assets/img/image-20201118111423350.ba3e5af5.png" alt="image-20201118111423350"></p> <p>回到上一层进入到register，创建bean的定义并且把packageNames设置给bean定义,然后把bean定义的做注册。</p> <p><img src="/study/assets/img/image-20201118111951726.d0758e59.png" alt="image-20201118111951726"></p> <h3 id="_2-3-自动配置"><a href="#_2-3-自动配置" class="header-anchor">#</a> 2.3 自动配置</h3> <p>springboot扫描当前classpath下所有的jar包，筛选出来EnableAutoConfiguration下的所有自动配置类注入到spring容器中，完成自动的bean的配置。</p> <p><img src="/study/assets/img/image-20201118112219348.dbdeecc2.png" alt="image-20201118112219348"></p> <h2 id="三、热部署"><a href="#三、热部署" class="header-anchor">#</a> 三、热部署</h2> <p>在实际开发过程中，每次修改代码就得将项目重启，重新部署，对于一些大型应用来说，重启时间需要花费大量的时间成本。对于一个后端开发者来说，重启过程确实很难受啊。在 Java 开发领域，热部署一直是一个难以解决的问题，目前的 Java 虚拟机只能实现方法体的修改热部署，对于整个类的结构修改，仍然需要重启虚拟机，对类重新加载才能完成更新操作。下面我们就看看对于简单的类修改的热部署怎么实现。</p> <h3 id="_3-1-原理"><a href="#_3-1-原理" class="header-anchor">#</a> 3.1 原理</h3> <p>深层原理是使用了两个ClassLoader，一个Classloader加载那些不会改变的类（第三方Jar包），另一个ClassLoader加载会更改的类，称为restart ClassLoader,这样在有代码更改的时候，原来的restart ClassLoader 被丢弃，重新创建一个restart ClassLoader，由于需要加载的类相比较少，所以实现了较快的重启时间。</p> <h3 id="_3-2-devtools-工具包"><a href="#_3-2-devtools-工具包" class="header-anchor">#</a> 3.2 devtools 工具包</h3> <p><strong>devtools</strong>：是boot的一个热部署工具，当我们修改了classpath下的文件（包括类文件、属性文件、页面等）时，会重新启动应用（由于其采用的双类加载器机制，这个启动会非常快，如果发现这个启动比较慢，可以选择使用jrebel）</p> <ul><li>双类加载器机制：boot使用了两个类加载器来实现重启（restart）机制：<strong>base类加载器</strong>（简称bc）、<strong>restart类加载器</strong>（简称rc）
<ul><li>bc：用于加载不会改变的jar（第三方依赖的jar）</li> <li>rc：用于加载我们正在开发的jar（整个项目里我们自己编写的类）。当应用重启后，原先的rc被丢掉、重新new一个rc来加载这些修改过的东西，而bc却不需要动一下。这就是devtools重启速度快的原因。</li></ul></li></ul> <p><strong>POM集成</strong></p> <p><img src="/study/assets/img/465907-20180827103241099-1675329980.f2afee8f.png" alt="img"></p> <p><em>下面这一步，我自己测试发现是不需要设置的。但是有网友说需要设置才生效，这个看个人情况，酌情设置。</em></p> <p><img src="/study/assets/img/465907-20180827103252591-2007938990.c46663af.png" alt="img"></p> <p><strong>IDEA工具启动自动编译功能</strong></p> <p><img src="/study/assets/img/465907-20180827103308161-468342759.2f685ab1.png" alt="img"></p> <p><strong>IDEA 设置为在程序运行过程中，依然允许自动编译</strong></p> <p>操作： ctrl + shift + alt + /，选择Registry，勾选勾上 Compiler autoMake allow when app running</p> <p><img src="/study/assets/img/465907-20180827103326210-48452697.02fb4c52.png" alt="img"></p> <p>执行完上述的操作步骤后，我们的devtools热部署集成就完成了。</p> <p><strong>补充说明</strong>：</p> <ul><li><em>默认情况下，/META-INF/maven，/META-INF/resources，/resources，/static，/templates，/public这些文件夹下的文件修改不会使应用重启，但是会重新加载（devtools内嵌了一个LiveReload server，当资源发生改变时，浏览器刷新）。</em></li> <li><em>如果想改变默认的设置，可以自己设置不重启的目录：spring.devtools.restart.exclude=static/<strong>,public/</strong>，这样的话，就只有这两个目录下的文件修改不会导致restart操作了。</em></li> <li><em>如果要在保留默认设置的基础上还要添加其他的排除目录：spring.devtools.restart.additional-exclude</em></li> <li><em>如果想要使得当非classpath下的文件发生变化时应用得以重启，使用：spring.devtools.restart.additional-paths，这样devtools就会将该目录列入了监听范围</em>。</li></ul> <h2 id="四、配置文件"><a href="#四、配置文件" class="header-anchor">#</a> 四、配置文件</h2> <h3 id="_4-1-配置文件位置"><a href="#_4-1-配置文件位置" class="header-anchor">#</a> 4.1 配置文件位置</h3> <p>springboot 启动会扫描以下位置的application.properties或者application.yml文件作为Spring boot的默认配置文件</p> <ul><li><p>–file:./config/</p></li> <li><p>–file:./ 项目的跟路径，如果当前的项目有父工程，配置文件要放在父工程 的根路径</p></li> <li><p>–classpath:/config/</p></li> <li><p>–classpath:/</p></li></ul> <p>优先级由高到底，高优先级的配置会覆盖低优先级的配置；</p> <p>SpringBoot会从这四个位置全部加载主配置文件；互补配置；</p> <p>如果我们的配置文件名字不叫application.properties或者application.yml，可以通过以下参数来指定配置文件的名字，myproject是配置文件名</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ java -jar myproject.jar --spring.config.name<span class="token operator">=</span>myproject
</code></pre></div><p>我们同时也可以指定其他位置的配置文件来生效</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ java -jar myproject.jar --spring.config.location<span class="token operator">=</span>classpath:/default.properties,classpath:/override.properties
</code></pre></div><h3 id="_4-2-yaml"><a href="#_4-2-yaml" class="header-anchor">#</a> 4.2 yaml</h3> <p>yml是YAML（YAML Ain't Markup Language）语言的文件，以数据为中心，比properties、xml等更适合做配置文件</p> <ul><li><p>yml和xml相比，少了一些结构化的代码，使数据更直接，一目了然。</p></li> <li><p>相比properties文件更简洁</p></li></ul> <h4 id="_4-2-1-yaml-语法"><a href="#_4-2-1-yaml-语法" class="header-anchor">#</a> 4.2.1 yaml 语法</h4> <p>以空格的缩进程度来控制层级关系。空格的个数并不重要，只要左边空格对齐则视为同一个层级。且大小写敏感。支持字面值，对象，数组三种数据结构，也支持复合结构。</p> <ul><li><p>字面值：字符串，布尔类型，数值，日期。字符串默认不加引号，单引号会转义特殊字符。日期格式支持yyyy/MM/dd HH:mm:ss</p></li> <li><p>对象：由键值对组成，形如 key:(空格)value 的数据组成。冒号后面的空格是必须要有的，每组键值对占用一行，且缩进的程度要一致，也可以使用行内写法：{k1: v1, ....kn: vn}</p></li> <li><p>数组：由形如 -(空格)value 的数据组成。短横线后面的空格是必须要有的，每组数据占用一行，且缩进的程度要一致，也可以使用行内写法： [1,2,...n]</p></li> <li><p>复合结构：上面三种数据结构任意组合</p></li></ul> <h4 id="_4-2-2-yaml-的使用"><a href="#_4-2-2-yaml-的使用" class="header-anchor">#</a> 4.2.2 yaml 的使用</h4> <p>创建一个Spring Boot 的全局配置文件 application.yml，配置属性参数。主要有字符串，带特殊字符的字符串，布尔类型，数值，集合，行内集合，行内对象，集合对象这几种常用的数据格式。</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">yaml</span><span class="token punctuation">:</span>
  <span class="token key atrule">str</span><span class="token punctuation">:</span> 字符串可以不加引号
  <span class="token key atrule">specialStr</span><span class="token punctuation">:</span> <span class="token string">&quot;双引号直接输出\n特殊字符&quot;</span>
  <span class="token key atrule">specialStr2</span><span class="token punctuation">:</span> <span class="token string">'单引号可以转义\n特殊字符'</span>
  <span class="token key atrule">flag</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
  <span class="token key atrule">num</span><span class="token punctuation">:</span> <span class="token number">666</span>
  <span class="token key atrule">Dnum</span><span class="token punctuation">:</span> <span class="token number">88.88</span>
  <span class="token key atrule">list</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> one
    <span class="token punctuation">-</span> two
    <span class="token punctuation">-</span> three
  <span class="token key atrule">set</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
  <span class="token key atrule">map</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">k1</span><span class="token punctuation">:</span> v1<span class="token punctuation">,</span> <span class="token key atrule">k2</span><span class="token punctuation">:</span> v2<span class="token punctuation">}</span>
  <span class="token key atrule">positions</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> txjava
      <span class="token key atrule">salary</span><span class="token punctuation">:</span> <span class="token number">15000.00</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> liangge
      <span class="token key atrule">salary</span><span class="token punctuation">:</span> <span class="token number">18888.88</span>
</code></pre></div><p>创建实体类YamlEntity.java 获取配置文件中的属性值，通过注解@ConfigurationProperties获取配置文件中的指定值并注入到实体类中。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;yaml&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YamlEntity</span> <span class="token punctuation">{</span>

    <span class="token comment">// 字面值，字符串，布尔，数值</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> str<span class="token punctuation">;</span> <span class="token comment">// 普通字符串</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> specialStr<span class="token punctuation">;</span> <span class="token comment">// 转义特殊字符串</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> specialStr2<span class="token punctuation">;</span><span class="token comment">// 输出特殊字符串</span>
    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> flag<span class="token punctuation">;</span>   <span class="token comment">// 布尔类型</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> num<span class="token punctuation">;</span>    <span class="token comment">// 整数</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> dNum<span class="token punctuation">;</span>    <span class="token comment">// 小数</span>

    <span class="token comment">// 数组，List和Set，两种写法： 第一种：-空格value，每个值占一行，需缩进对齐；第二种：[1,2,...n] 行内写法</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">;</span>  <span class="token comment">// list可重复集合</span>
    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> set<span class="token punctuation">;</span>    <span class="token comment">// set不可重复集合</span>

    <span class="token comment">// Map和实体类，两种写法：第一种：key空格value，每个值占一行，需缩进对齐；第二种：{key: value,....} 行内写法</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">;</span> <span class="token comment">// Map K-V</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Position</span><span class="token punctuation">&gt;</span></span> positions<span class="token punctuation">;</span>  <span class="token comment">// 复合结构，集合对象</span>

    <span class="token comment">// 省略getter，setter，toString方法</span>
</code></pre></div><h4 id="_4-2-3-总结"><a href="#_4-2-3-总结" class="header-anchor">#</a> 4.2.3 总结</h4> <ul><li><p>字符串可以不加引号，若加双引号则输出特殊字符，若不加或加单引号则转义特殊字符；</p></li> <li><p>数组类型，短横线后面要有空格；对象类型，冒号后面要有空格；</p></li> <li><p>YAML是以空格缩进的程度来控制层级关系，但不能用tab键代替空格，大小写敏感；</p></li> <li><p>yaml的缺点是可读性比较差</p></li></ul> <h3 id="_4-3-属性绑定"><a href="#_4-3-属性绑定" class="header-anchor">#</a> 4.3 属性绑定</h3> <p>前面给大家讲了yaml的语法和绑定注入给实体类，那我们平时在工作中多数是在通过实体类来写yaml的配置。属性的绑定我们必须要提供set方法</p> <p>提供一段来自官网的代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;acme&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AcmeProperties</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">boolean</span> enabled<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">InetAddress</span> remoteAddress<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Security</span> security <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Security</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> enabled<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> enabled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> enabled<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">InetAddress</span> <span class="token function">getRemoteAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> remoteAddress<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setRemoteAddress</span><span class="token punctuation">(</span><span class="token class-name">InetAddress</span> remoteAddress<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>remoteAddress <span class="token operator">=</span> remoteAddress<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Security</span> <span class="token function">getSecurity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> security<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Security</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> roles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token string">&quot;USER&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> username<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> password<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> roles<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setRoles</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> roles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>roles <span class="token operator">=</span> roles<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>为了让当前的实体类能在配置文件中有对应的提示，我们需要引入如下的依赖，</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-configuration-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>加完依赖后通过Ctrl+F9来使之生效。</p> <p><img src="/study/assets/img/image-20201118161656905.656ddd2b.png" alt="image-20201118161656905"></p> <p>在配置文件中加入</p> <p><img src="/study/assets/img/image-20201118161707612.a0235a8d.png" alt="image-20201118161707612"></p> <p>然后我们测试绑定的情况。</p> <p>在属性绑定的方式里，我们是通过set方法来完成的，我们可以借助Lombok来给我们带来方便。</p> <p>我们在父工程中引入Lombok的依赖：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.16.20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>修改属性类：加上@Data注解，然后测试结果相同。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;acme&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AcmeProperties</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">boolean</span> enabled<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">InetAddress</span> remoteAddress<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Security</span> security <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Security</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    
    <span class="token annotation punctuation">@Data</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Security</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> roles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token string">&quot;USER&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-4-构造器绑定"><a href="#_4-4-构造器绑定" class="header-anchor">#</a> 4.4 构造器绑定</h3> <p>让我们采用构造器的方式来定义</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;acme&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConstructorBinding</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AcmeProperties</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">boolean</span> enabled<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">InetAddress</span> remoteAddress<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Security</span> security <span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">AcmeProperties</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> enabled<span class="token punctuation">,</span> <span class="token class-name">InetAddress</span> remoteAddress<span class="token punctuation">,</span> <span class="token class-name">Security</span> security<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> enabled<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>remoteAddress <span class="token operator">=</span> remoteAddress<span class="token punctuation">;</span> 
        <span class="token keyword">this</span><span class="token punctuation">.</span>security <span class="token operator">=</span> security<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> enabled<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">InetAddress</span> <span class="token function">getRemoteAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> remoteAddress<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Security</span> <span class="token function">getSecurity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> security<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Security</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> roles<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">Security</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">,</span>
                        <span class="token annotation punctuation">@DefaultValue</span><span class="token punctuation">(</span><span class="token string">&quot;USER&quot;</span><span class="token punctuation">)</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> roles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>roles <span class="token operator">=</span> roles<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> username<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> password<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> roles<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>要使用构造函数绑定，必须使用 @EnableConfigurationProperties 或配置属性扫描启用类。不能对由常规Spring机制创建的Bean使用构造函数绑定（例如@Component）</p> <p>测试的Controller</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">AcmeProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YamlController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AcmeProperties</span> acmeProperties<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;yaml&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">AcmeProperties</span> <span class="token function">yaml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>acmeProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> acmeProperties<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>测试成功。在属性绑定的案例中我们同样也可以使用@EnableConfigurationProperties，此时不需要提供@Component</p> <p>如果一个配置类只配置@ConfigurationProperties注解，而没有使用@Component，那么在IOC容器中是获取不到properties 配置文件转化的bean。说白了 @EnableConfigurationProperties 相当于把使用 @ConfigurationProperties 的类进行了启用注入。</p> <p>在之前的版本我们都是使用@Configuration来进行作为配置类，<a href="mailto:%E4%BB%8ESpringBoot2.2.1.RELEASE%E7%89%88%E6%9C%AC%E5%BC%80%E5%A7%8B%E6%88%91%E4%BB%AC%E4%B8%8D%E5%86%8D%E9%9C%80%E8%A6%81%E6%B7%BB%E5%8A%A0@Configuration">从SpringBoot2.2.1.RELEASE版本开始我们不再需要添加@Configuration</a>。</p> <p>我们可以在扫描范围的bean的内部之间定义bean如：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YamlController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Dep</span> <span class="token function">getDep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AcmeProperties</span> acmeProperties<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-5-第三方组件注入"><a href="#_4-5-第三方组件注入" class="header-anchor">#</a> 4.5 第三方组件注入</h3> <p>除了使用@ConfigurationProperties注释类之外，还可以在public@Bean方法上使用它。如果要将属性绑定到不在您控制范围内的第三方组件</p> <p>依然采用之前的案例的yaml配置</p> <p>创建一个其他组件类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AnotherComponent</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">boolean</span> enabled<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">InetAddress</span> remoteAddress<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>创建MyService</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;acme&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">AnotherComponent</span> <span class="token function">anotherComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AnotherComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们通过测试可以获得AnotherComponent组件的实例对象。</p> <h3 id="_4-6-松散绑定"><a href="#_4-6-松散绑定" class="header-anchor">#</a> 4.6 松散绑定</h3> <p>Spring Boot使用一些宽松的规则将环境属性绑定到@ConfigurationProperties bean，因此环境属性名和bean属性名之间不需要完全匹配。</p> <p>例如属性类：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;acme.my-person.person&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OwnerProperties</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> firstName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>配置文件：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">acme</span><span class="token punctuation">:</span>
  <span class="token key atrule">my-person</span><span class="token punctuation">:</span>
    <span class="token key atrule">person</span><span class="token punctuation">:</span>
      <span class="token key atrule">first-name</span><span class="token punctuation">:</span> 泰森
</code></pre></div><table><thead><tr><th>属性文件中配置</th> <th>说明</th></tr></thead> <tbody><tr><td>acme.my-project.person.first-name</td> <td>羊肉串模式case, 推荐使用</td></tr> <tr><td>acme.myProject.person.firstName</td> <td>标准驼峰模式</td></tr> <tr><td>acme.my_project.person.first_name</td> <td>下划线模式</td></tr> <tr><td>ACME_MYPROJECT_PERSON_FIRSTNAME</td> <td>大写下划线，如果使用系统环境时候推荐使用</td></tr></tbody></table> <h3 id="_4-7-configurationproperties-校验"><a href="#_4-7-configurationproperties-校验" class="header-anchor">#</a> 4.7 @ConfigurationProperties 校验</h3> <p>每当使用Spring的@Validated注释对@ConfigurationProperties类进行注释时，Spring Boot就会尝试验证它们。你可以用JSR-303 javax.validation直接在配置类上的约束注释。为此，请确保类路径上有一个兼容的JSR-303实现，此处我们用的是hibernate的实现，然后将约束注释添加到字段中</p> <ol><li><p>引入依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.hibernate<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hibernate-validator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.2.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>在属性类上加入注解</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;acme.my-person.person&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Validated</span> <span class="token comment">//spring提供的注解</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OwnerProperties</span> <span class="token punctuation">{</span>
    
	<span class="token annotation punctuation">@NotNull</span>   <span class="token comment">//javax.validation.constraints提供</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> firstName<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Max</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Email</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>配置文件</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">acme</span><span class="token punctuation">:</span>
  <span class="token key atrule">my-person</span><span class="token punctuation">:</span>
    <span class="token key atrule">person</span><span class="token punctuation">:</span>
      <span class="token key atrule">FIRST_name</span><span class="token punctuation">:</span> 泰森
      <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">34</span>
      <span class="token key atrule">email</span><span class="token punctuation">:</span> aaa
</code></pre></div><p>启动主启动类的时候，会自动发生校验。</p></li></ol> <h3 id="_4-8-configurationproperties-vs-value"><a href="#_4-8-configurationproperties-vs-value" class="header-anchor">#</a> 4.8 @ConfigurationProperties vs. @Value</h3> <table><thead><tr><th>Feature</th> <th>@ConfigurationProperties</th> <th>@Value</th></tr></thead> <tbody><tr><td>松散绑定</td> <td>Yes</td> <td>Limit</td></tr> <tr><td>元数据支持</td> <td>Yes</td> <td>No</td></tr> <tr><td>SpEL 表达式</td> <td>No</td> <td>Yes</td></tr> <tr><td>复杂类型绑定</td> <td>Yes</td> <td>No</td></tr> <tr><td>校验</td> <td>Yes</td> <td>No</td></tr> <tr><td>应用场景</td> <td>Boot里面属性多个绑定</td> <td>单个属性的绑定</td></tr></tbody></table> <ol><li><p><a href="mailto:1.%E6%9D%BE%E6%95%A3%E7%BB%91%E5%AE%9A%E5%9C%A8@value">松散绑定在@value</a>是被限制的</p> <p>如果您确实想使用@Value，建议引用属性名（kebab case只使用小写字母，既是羊肉串模式）。这允许Spring Boot使用与放松binding@ConfigurationProperties时相同的逻辑。例如，@Value（“${demo.item-price}）将匹配demo.item-price和demo.itemPrice， 其他模式不能匹配。</p></li> <li><p>元数据支持</p> <p>我们在@ConfigurationProperties方式可以生成元数据，目的是给我们提供提示和属性的描述。但是在@value里面是没有的。@Value适合单个的属性注入</p></li> <li><p>spEL在@ConfigurationProperties中是不能支持的。在@Value中可以支持</p> <p><img src="data:image/jpeg;base64,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" alt="img"></p></li> <li><p>@Value复杂类型不可注入，会有启动报错。</p></li></ol> <h3 id="_4-9-profile"><a href="#_4-9-profile" class="header-anchor">#</a> 4.9 Profile</h3> <p>Profile是Spring对不同环境提供不同配置功能的支持,可以通过激活,指定参数等方式快速切换环境;</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span> default
<span class="token key atrule">acme</span><span class="token punctuation">:</span>
  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">remote-address</span><span class="token punctuation">:</span> 192.168.0.108
<span class="token punctuation">---</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span> development
<span class="token key atrule">acme</span><span class="token punctuation">:</span>
  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">remote-address</span><span class="token punctuation">:</span> 192.168.0.109
<span class="token punctuation">---</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span> production
<span class="token key atrule">acme</span><span class="token punctuation">:</span>
  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">remote-address</span><span class="token punctuation">:</span> 192.168.0.110
</code></pre></div><p>在启动的时候我们通过<code>spring.profiles.active: development</code>来指定开启哪个profile</p> <p>我们也可以采用多个文件来做。</p> <ul><li>主配置文件的文件名,可以是<code>application-{profile}.properties</code>;</li> <li>默认使用<code>application.properties</code>的配置;</li> <li>在配置文件中,使用<code>spring.profiles.active:dev</code>激活使用;</li></ul> <p><img src="/study/assets/img/wps2.809f8033.jpg" alt="img"></p> <p>属性类：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;acme&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AcmeProperties</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">boolean</span> enabled<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">InetAddress</span> remoteAddress<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> host<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>我们可以通过profile的指定来启用指定的文件。</p> <p>application-dev.yml</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">acme</span><span class="token punctuation">:</span>
  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">remote-address</span><span class="token punctuation">:</span> 192.168.0.109
  <span class="token key atrule">host</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>acme.remote<span class="token punctuation">-</span>address<span class="token punctuation">}</span><span class="token punctuation">:</span><span class="token number">8080</span>
</code></pre></div><p>application-pro.yml</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">acme</span><span class="token punctuation">:</span>
  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">remote-address</span><span class="token punctuation">:</span> 192.168.0.110
  <span class="token key atrule">host</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>acme.remote<span class="token punctuation">-</span>address<span class="token punctuation">}</span><span class="token punctuation">:</span><span class="token number">8080</span>
</code></pre></div><p>我们依然在启动的时候我们通过`--pring.profiles.active=dev来指定。</p> <h2 id="五、java-中的-spi"><a href="#五、java-中的-spi" class="header-anchor">#</a> 五、Java 中的 SPI</h2> <h3 id="_5-1-什么是java的spi"><a href="#_5-1-什么是java的spi" class="header-anchor">#</a> 5.1 什么是java的SPI</h3> <p>SPI全称Service Provider Interface，是Java提供的一套用来被第三方实现或者扩展的API，它可以用来启用框架扩展和替换组件。</p> <p><img src="/study/assets/img/20200520144938989.7b8326a5.png" alt="在这里插入图片描述"></p> <p>Java SPI 实际上是“<strong>基于接口的编程＋策略模式＋配置文件</strong>”组合实现的动态加载机制。</p> <p>系统设计的各个抽象，往往有很多不同的实现方案，在面向的对象的设计里，一般推荐模块之间基于接口编程，模块之间不对实现类进行硬编码。一旦代码里涉及具体的实现类，就违反了可拔插的原则，如果需要替换一种实现，就需要修改代码。为了实现在模块装配的时候能不在程序里动态指明，这就需要一种服务发现机制。
Java SPI就是提供这样的一个机制：为某个接口寻找服务实现的机制。有点类似IOC的思想，就是将装配的控制权移到程序之外，在模块化设计中这个机制尤其重要。所以SPI的核心思想就是解耦。</p> <h3 id="_5-2-spi-应用场景"><a href="#_5-2-spi-应用场景" class="header-anchor">#</a> 5.2 SPI 应用场景</h3> <p>比较常见的例子：</p> <ul><li>JDBC加载不同类型数据库的驱动</li> <li>SLF4J加载不同提供商的日志实现类</li> <li>Spring中大量使用了SPI,比如：对servlet3.0规范对ServletContainerInitializer的实现、自动类型转换Type Conversion SPI(Converter SPI、Formatter SPI)等</li></ul> <h3 id="_5-3-java-spi-规范"><a href="#_5-3-java-spi-规范" class="header-anchor">#</a> 5.3 Java SPI 规范</h3> <p>要使用Java SPI，需要遵循如下约定：</p> <ol><li>当服务提供者提供了接口的一种具体实现后，在jar包的META-INF/services目录下创建一个以“接口全限定名”为命名的文件，内容为实现类的全限定名；</li> <li>接口实现类所在的jar包放在主程序的classpath中；</li> <li>主程序通过java.util.ServiceLoder动态装载实现模块，它通过扫描META-INF/services目录下的配置文件找到实现类的全限定名，把类加载到JVM；</li> <li>SPI的实现类必须携带一个不带参数的构造方法；</li></ol> <h3 id="_5-4-案例代码"><a href="#_5-4-案例代码" class="header-anchor">#</a> 5.4 案例代码</h3> <ol><li><p>创建父工程</p> <p><img src="/study/assets/img/image-20201120142015990.40ae826c.png" alt="image-20201120142015990"></p></li> <li><p>创建service-common工程</p> <p><img src="/study/assets/img/20200520150700161.f759d95a.png" alt="在这里插入图片描述"></p> <p>此工程模块为其他工程的公共的依赖模块，在其中定义PayService接口</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PayService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>创建ali-pay工程</p> <p><img src="/study/assets/img/image-20201120142140689.7d84ee09.png" alt="image-20201120142140689"></p> <p>在pom.xml文件中引入依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.tx.spi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>service-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>创建PayService的实现类AliPayService</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AliPayService</span> <span class="token keyword">implements</span> <span class="token class-name">PayService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;支付宝支付&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在resources下创建META-INF.services包</p> <p>创建cn.tx.service.PayService文件内容如下：指定文件名所示的接口的实现类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">cn<span class="token punctuation">.</span>tx<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span>AliPayService</span>
</code></pre></div></li> <li><p>创建wx-pay工程</p> <p><img src="/study/assets/img/image-20201120142324371.d9a5f29f.png" alt="image-20201120142324371"></p> <p>在pom.xml文件中引入依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.tx.spi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>service-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>创建PayService的实现类WxPayService</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WxPayService</span> <span class="token keyword">implements</span> <span class="token class-name">PayService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;微信支付&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在resources下创建META-INF.services包
创建cn.tx.service.PayService文件内容如下：指定文件名所示的接口的实现类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">cn<span class="token punctuation">.</span>tx<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span>WxPayService</span>
</code></pre></div></li> <li><p>创建main-pay工程(测试工程)</p> <p>引入依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.tx.spi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>service-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.tx.spi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ali-pay<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--&lt;dependency&gt;
            &lt;groupId&gt;cn.tx.spi&lt;/groupId&gt;
            &lt;artifactId&gt;wx-pay&lt;/artifactId&gt;
            &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
        &lt;/dependency&gt;--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>创建测试类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PayService</span><span class="token punctuation">&gt;</span></span> services <span class="token operator">=</span> <span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">PayService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">PayService</span> service <span class="token operator">:</span> services<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            service<span class="token punctuation">.</span><span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>执行测试：我们可以看到我们引入的Ali-pay就能得到AlipayService的实现类实例</p> <p><img src="data:image/png;base64,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gAMgAAIgcLcEbihqvbJmNV5Ts2tsQqh00iezf9ibbsn0o15h5qibYsyu6WXOcofv0d+iQ/gSBEAABFZH4Iaixix603WZrR1240dhY8hQxWnvyqRrTD1t9FCGa+WRGtulvZ4jalzfPfnLNuMVBEAABO6DwApEjTZudOp6lN0+PzVKo4eth6FTKmpui39YZ+OQ3FbU7slfJoZXEAABELgPAqsQNWNOZp+KV9Uo7RSN8saiZrc62kcBZPWXF7X8c216GtyLv7r1OAoCIAACayWwElFz2+yD8LgNFHO31auipjyQXSdquTUwt21fPsNG635Tv2KSJgDZsC5/UwvxGQRAAATuj8BqRI2nCmkmsU50xrB1UdPL7YKijAtkj1xiTY0rD3Wt11+2Fa8gAAIgcB8EViRqYapw9zD9qyAa3muLmr2efMZNM6p0zE6x0s9urdXfkvH4DgRAAATWR2A9otaf7K9r0M9TuW385V/a11BeW9TIBruZpeKnuUb23oW/I6txAARAAARWTWAVotaf9uaBfmLK77/vzanbu996pOfPTqfsDwxLurcQNUOjLR5p2Qe2pUX6+/vxV7cfR0EABEBgrQRuKGq9kZ278jgZzUcGcbM/ZkxTdcPvKypES7/Z2Ped/cFhEk/69Y/cmpp9tk37IWN7jEaR440ibtNIZ/9bGvrBZX25bp3+KhhxCARAAATulsCVRY069s50Hf36h/5gdJZk7wSu86O5cUl6CDuM9sbf2yN2VLhsDStTY+Fwa/4WUOArEAABELgCgSuL2hU8wiVAAARAAASaJQBRazb0cBwEQAAEtkcAora9mMIjEAABEGiWAESt2dDDcRAAARDYHgGI2vZiCo9AAARAoFkCELVmQw/HQQAEQGB7BCBq24spPAIBEACBZglA1JoNPRwHARAAge0RgKhtL6bwCARAAASaJQBRazb0cBwEQAAEtkcAora9mMIjEAABEGiWAESt2dDDcRAAARDYHgGI2vZiCo9AAARAoFkCELVmQw/HQQAEQGB7BCBq24spPAIBEACBZglA1JoNPRwHARAAge0RgKhtL6bwCARAAASaJQBRazb0cBwEQAAEtkcAora9mMIjEAABEGiWAESt2dDDcRAAARDYHgGI2vZiCo9AAARAoFkCELVmQw/HQQAEQGB7BCBq24spPAIBEACBZglA1JoNPRwHARAAge0RgKhtL6bwCARAAASaJQBRazb0cBwEQAAEtkcAora9mMIjEAABEGiWAESt2dDDcRAAARDYHgGI2vZiCo9AAARAoFkC/wcXQAmgur6frgAAAABJRU5ErkJggg==" alt="在这里插入图片描述"></p> <p>如果我在pom中切换依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.tx.spi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>service-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--&lt;dependency&gt;
            &lt;groupId&gt;cn.tx.spi&lt;/groupId&gt;
            &lt;artifactId&gt;ali-pay&lt;/artifactId&gt;
            &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
        &lt;/dependency&gt;--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.tx.spi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>wx-pay<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>再次执行测试：我们可以看到我们引入的wx-pay就能得到WxpayService的实现类实例</p> <p><img src="data:image/png;base64,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" alt="在这里插入图片描述"></p> <p>如果两种支付的依赖都引入</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.tx.spi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>service-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.tx.spi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ali-pay<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.tx.spi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>wx-pay<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>测试结果</p> <p><img src="data:image/png;base64,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" alt="在这里插入图片描述"></p></li></ol> <h3 id="_5-5-总结"><a href="#_5-5-总结" class="header-anchor">#</a> 5.5 总结</h3> <p>使用Java SPI机制的优势是实现解耦，使得第三方服务模块的装配控制的逻辑与调用者的业务代码分离，而不是耦合在一起。应用程序可以根据实际业务情况启用框架扩展或替换框架组件。
Springboot的原理即是使用期原理来做的自动配置。</p> <h2 id="六、spring-boot-中的-spi-机制"><a href="#六、spring-boot-中的-spi-机制" class="header-anchor">#</a> 六、Spring Boot 中的 SPI 机制</h2> <p>在Spring中也有一种类似与Java SPI的加载机制。它在META-INF/spring.factories文件中配置接口的实现类名称，然后在程序中读取这些配置文件并实例化。
这种自定义的SPI机制是Spring Boot Starter实现的基础。</p> <p><img src="/study/assets/img/image-20201118170135064.6f6c2cbe.png" alt="image-20201118170135064"></p> <h3 id="_5-1-spring-factories-实现原理"><a href="#_5-1-spring-factories-实现原理" class="header-anchor">#</a> 5.1 Spring Factories 实现原理</h3> <p>spring-core包里定义了SpringFactoriesLoader类，这个类实现了检索META-INF/spring.factories文件，并获取指定接口的配置的功能。在这个类中定义了两个对外的方法：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">loadFactoryNames</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> factoryClass<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ClassLoader</span> classLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//获得接口名字</span>
   <span class="token class-name">String</span> factoryClassName <span class="token operator">=</span> factoryClass<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//获得所有配置类，并且根据接口名字来获得</span>
   <span class="token keyword">return</span> <span class="token function">loadSpringFactories</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>factoryClassName<span class="token punctuation">,</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">loadSpringFactories</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ClassLoader</span> classLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//从缓存中获得spring.factories的全量信息</span>
    <span class="token class-name">MultiValueMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MultiValueMap</span><span class="token punctuation">)</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
<span class="token comment">//在classpath下的所有jar包中查找META-INF/spring.factories文件</span>
            <span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span>URL<span class="token punctuation">&gt;</span></span> urls <span class="token operator">=</span> classLoader <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> classLoader<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token string">&quot;META-INF/spring.factories&quot;</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemResources</span><span class="token punctuation">(</span><span class="token string">&quot;META-INF/spring.factories&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//定义存储全量工厂类的map</span>
            <span class="token class-name">LinkedMultiValueMap</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedMultiValueMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//遍历urls</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>urls<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">URL</span> url <span class="token operator">=</span> <span class="token punctuation">(</span>URL<span class="token punctuation">)</span>urls<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">UrlResource</span> resource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlResource</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//加载属性集和</span>
                <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token class-name">PropertiesLoaderUtils</span><span class="token punctuation">.</span><span class="token function">loadProperties</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Iterator</span> var6 <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//遍历属性键值对的键</span>
                <span class="token keyword">while</span><span class="token punctuation">(</span>var6<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token punctuation">)</span>var6<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//获得key接口</span>
                    <span class="token class-name">String</span> factoryClassName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var9 <span class="token operator">=</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">commaDelimitedListToStringArray</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">int</span> var10 <span class="token operator">=</span> var9<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                     <span class="token comment">//切分并且遍历接口实现类，加入结果集</span>
                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> var11 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> var11 <span class="token operator">&lt;</span> var10<span class="token punctuation">;</span> <span class="token operator">++</span>var11<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token class-name">String</span> factoryName <span class="token operator">=</span> var9<span class="token punctuation">[</span>var11<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factoryClassName<span class="token punctuation">,</span> factoryName<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> result<span class="token punctuation">;</span>
              <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> var13<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;Unable to load factories from location [META-INF/spring.factories]&quot;</span><span class="token punctuation">,</span> var13<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>从代码中我们可以知道，在这个方法中会遍历整个ClassLoader中所有jar包下的spring.factories文件。也就是说我们可以在自己的jar中配置spring.factories文件，不会影响到其它地方的配置，也不会被别人的配置覆盖。</p> <p>spring.factories的是通过Properties解析得到的，所以我们在写文件中的内容都是安装下面这种方式配置的：</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">com.xxx.interface</span><span class="token punctuation">=</span><span class="token attr-value">com.xxx.classname</span>
</code></pre></div><p>如果一个接口希望配置多个实现类，可以使用’,’进行分割。</p> <p>在Spring Boot的很多包中都能够找到spring.factories文件，下面就是spring-boot包中的spring.factories文件</p> <p>在Spring Boot中，使用的最多的就是starter。starter可以理解为一个可拔插式的插件，例如，你想使用JDBC插件，那么可以使用spring-boot-starter-jdbc；如果想使用MongoDB，可以使用spring-boot-starter-data-mongodb。</p> <p>初学的同学可能会说：如果我要使用MongoDB，我直接引入驱动jar包就行了，何必要引入starter包？starter和普通jar包的区别在于，它能够实现自动配置，和Spring Boot无缝衔接，从而节省我们大量开发时间。</p> <h3 id="_5-2-自动配置类原理"><a href="#_5-2-自动配置类原理" class="header-anchor">#</a> 5.2 自动配置类原理</h3> <p>我们可以发现在spring-boot-autoconfigure中的spring.factories里面保存着springboot的默认提供的自动配置类。</p> <p><img src="/study/assets/img/image-20201118171136203.9e41600e.png" alt="image-20201118171136203"></p> <p>让我们看在哪里去创建这些类的。我们可以关注@springbootApplication注解，在boot启动类的bean定义被加载的会执行当前的注解。</p> <p><img src="/study/assets/img/image-20201118171207930.f2d635e9.png" alt="image-20201118171207930"></p> <p>进入到@EnableAutoConfiguration注解</p> <p><img src="/study/assets/img/image-20201118171220908.2e645cc2.png" alt="image-20201118171220908"></p> <p>@AutoConfigurationImportSelector是引入自动配置类的位置。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">AutoConfigurationEntry</span> <span class="token function">getAutoConfigurationEntry</span><span class="token punctuation">(</span>
      <span class="token class-name">AutoConfigurationMetadata</span> autoConfigurationMetadata<span class="token punctuation">,</span>
      <span class="token class-name">AnnotationMetadata</span> annotationMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isEnabled</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> EMPTY_ENTRY<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
    <span class="token class-name">AnnotationAttributes</span> attributes <span class="token operator">=</span> <span class="token function">getAttributes</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//获得所有的自动配置类</span>
   <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations <span class="token operator">=</span> <span class="token function">getCandidateConfigurations</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span>
         attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//排除重复</span>
   configurations <span class="token operator">=</span> <span class="token function">removeDuplicates</span><span class="token punctuation">(</span>configurations<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//排除手动设置的重复</span>
   <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> exclusions <span class="token operator">=</span> <span class="token function">getExclusions</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">checkExcludedClasses</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//移除排除的自动配置类</span>
   configurations<span class="token punctuation">.</span><span class="token function">removeAll</span><span class="token punctuation">(</span>exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//过滤掉没有引入的自动配置类</span>
   configurations <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> autoConfigurationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">fireAutoConfigurationImportEvents</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AutoConfigurationEntry</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-3-条件判断-conditional"><a href="#_5-3-条件判断-conditional" class="header-anchor">#</a> 5.3 条件判断@Conditional</h3> <p>@Conditional表示仅当所有指定条件都匹配时，组件才有资格注册 。
该@Conditional注释可以在以下任一方式使用：</p> <ul><li>作为任何@Bean方法的方法级注释</li> <li>作为任何类的直接或间接注释的类型级别注释 @Component，包括@Configuration类</li></ul> <p>改注解主要源码之一，通过match匹配，符合条件才装载到Spring容器</p> <p><strong>作用：总而言之，只有@Conditional指定的条件成立，才给容器添加组件</strong></p> <p>@Conditional派生注解：@Conditional派生了很多注解，下面给个表格列举一下派生注解的用法</p> <table><thead><tr><th>@Conditional派生注解</th> <th>作用(都是判断是否符合指定的条件)</th></tr></thead> <tbody><tr><td>@ConditionalOnJava</td> <td>系统的java版本是否符合要求</td></tr> <tr><td>@ConditionalOnBean</td> <td>有指定的Bean类</td></tr> <tr><td>@ConditionalOnMissingBean</td> <td>没有指定的bean类</td></tr> <tr><td>@ConditionalOnExpression</td> <td>符合指定的SpEL表达式</td></tr> <tr><td>@ConditionalOnClass</td> <td>有指定的类</td></tr> <tr><td>@ConditionalOnMissingClass</td> <td>没有指定的类</td></tr> <tr><td>@ConditionalOnSingleCandidate</td> <td>容器只有一个指定的bean，或者这个bean是首选bean</td></tr> <tr><td>@ConditionalOnProperty</td> <td>指定的property属性有指定的值</td></tr> <tr><td>@ConditionalOnResource</td> <td>路径下存在指定的资源</td></tr> <tr><td>@ConditionalOnWebApplication</td> <td>系统环境是web环境</td></tr> <tr><td>@ConditionalOnNotWebApplication</td> <td>系统环境不是web环境</td></tr> <tr><td>@ConditionalOnjndi</td> <td>JNDI存在指定的项</td></tr></tbody></table> <h2 id="七、spring-boot-数据源自动配置"><a href="#七、spring-boot-数据源自动配置" class="header-anchor">#</a> 七、Spring Boot 数据源自动配置</h2> <h3 id="_7-1-数据源自动管理"><a href="#_7-1-数据源自动管理" class="header-anchor">#</a> 7.1 数据源自动管理</h3> <p>引入jdbc的依赖和springboot的应用场景</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>让我们使用yaml方式配置，创建application.yaml</p> <p>在默认情况下， 数据库连接可以使用DataSource池进行自动配置</p> <ul><li>默认Hikari可用， Springboot将使用它。</li></ul> <p>我们可以自己指定数据源配置，通过type来选取使用哪种数据源</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> root
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/boot_demo
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
    <span class="token key atrule">type</span><span class="token punctuation">:</span> com.zaxxer.hikari.HikariDataSource
   <span class="token comment"># type: org.apache.commons.dbcp2.BasicDataSource</span>
</code></pre></div><h3 id="_7-2-数据源自动配置原理"><a href="#_7-2-数据源自动配置原理" class="header-anchor">#</a> 7.2 数据源自动配置原理</h3> <p>在数据源自动配置类里面我们可以看到默认支持的数据源类型</p> <p><img src="/study/assets/img/image-20201120172409058.5fd02f95.png" alt="image-20201120172409058"></p> <p>我们可以看到三种数据源的配置</p> <p><img src="/study/assets/img/image-20201120172432513.3ffdc4a6.png" alt="image-20201120172432513"></p> <p>点开starter-jdbc我们可以看到Hikari是默认的数据源</p> <p><img src="/study/assets/img/image-20201120172738415.71b232c2.png" alt="image-20201120172738415"></p> <h3 id="_7-3-配置-druid-数据源"><a href="#_7-3-配置-druid-数据源" class="header-anchor">#</a> 7.3 配置 Druid 数据源</h3> <p>引入druid的依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.9<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>修改spring.datasource.type=com.alibaba.druid.pool.DruidDataSource</p> <p>在application.yaml中加入</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> root
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/boot_demo
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
    <span class="token key atrule">type</span><span class="token punctuation">:</span> com.alibaba.druid.pool.DruidDataSource
    <span class="token key atrule">initialSize</span><span class="token punctuation">:</span> <span class="token number">5</span>
    <span class="token key atrule">minIdle</span><span class="token punctuation">:</span> <span class="token number">5</span>
    <span class="token key atrule">maxActive</span><span class="token punctuation">:</span> <span class="token number">20</span>
    <span class="token key atrule">maxWait</span><span class="token punctuation">:</span> <span class="token number">60000</span>
    <span class="token key atrule">timeBetweenEvictionRunsMillis</span><span class="token punctuation">:</span> <span class="token number">60000</span>
    <span class="token key atrule">minEvictableIdleTimeMillis</span><span class="token punctuation">:</span> <span class="token number">300000</span>
    <span class="token key atrule">validationQuery</span><span class="token punctuation">:</span> SELECT 1 FROM DUAL
    <span class="token key atrule">testWhileIdle</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">testOnBorrow</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">testOnReturn</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">poolPreparedStatements</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">filters</span><span class="token punctuation">:</span> stat<span class="token punctuation">,</span>wall<span class="token punctuation">,</span>log4j
    <span class="token key atrule">maxPoolPreparedStatementPerConnectionSize</span><span class="token punctuation">:</span> <span class="token number">20</span>
    <span class="token key atrule">useGlobalDataSourceStat</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">connectionProperties</span><span class="token punctuation">:</span> druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500
</code></pre></div><p>创建数据源注册类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DruidConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.datasource&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="八、自定义-starter"><a href="#八、自定义-starter" class="header-anchor">#</a> 八、自定义 Starter</h2> <h3 id="_8-1-springboot-starter机制"><a href="#_8-1-springboot-starter机制" class="header-anchor">#</a> 8.1 SpringBoot starter机制</h3> <p>SpringBoot中的starter是一种非常重要的机制，能够抛弃以前繁杂的配置，将其统一集成进starter，应用者只需要在maven中引入starter依赖，SpringBoot就能自动扫描到要加载的信息并启动相应的默认配置。starter让我们摆脱了各种依赖库的处理，需要配置各种信息的困扰。SpringBoot会自动通过classpath路径下的类发现需要的Bean，并注册进IOC容器。SpringBoot提供了针对日常企业应用研发各种场景的spring-boot-starter依赖模块。所有这些依赖模块都遵循着约定成俗的默认配置，并允许我们调整这些配置，即遵循“约定大于配置”的理念。</p> <h3 id="_8-2-为什么要自定义starter"><a href="#_8-2-为什么要自定义starter" class="header-anchor">#</a> 8.2 为什么要自定义starter</h3> <p>在我们的日常开发工作中，经常会有一些独立于业务之外的配置模块，我们经常将其放到一个特定的包下，然后如果另一个工程需要复用这块功能的时候，需要将代码硬拷贝到另一个工程，重新集成一遍，麻烦至极。如果我们将这些可独立于业务代码之外的功配置模块封装成一个个starter，复用的时候只需要将其在pom中引用依赖即可，SpringBoot为我们完成自动装配，简直不要太爽。</p> <h3 id="_8-3-自定义starter的命名规则"><a href="#_8-3-自定义starter的命名规则" class="header-anchor">#</a> 8.3 自定义starter的命名规则</h3> <p>SpringBoot提供的starter以<code>spring-boot-starter-xxx</code>的方式命名的。官方建议自定义的starter使用<code>xxx-spring-boot-starter</code>命名规则。以区分SpringBoot生态提供的starter。</p> <h3 id="_8-4-实例"><a href="#_8-4-实例" class="header-anchor">#</a> 8.4 实例</h3> <h4 id="_8-4-1-新建工程"><a href="#_8-4-1-新建工程" class="header-anchor">#</a> 8.4.1 新建工程</h4> <p>命名为demo-spring-boot-starter</p> <p><img src="/study/assets/img/1635748-20190514214456549-79818005.c8ba91a9.png" alt="img"></p> <h4 id="_8-4-2-引入-pom-依赖"><a href="#_8-4-2-引入-pom-依赖" class="header-anchor">#</a> 8.4.2 引入 pom 依赖</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.4.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>demo-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.0.1-RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>demo-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Demo project for Spring Boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-configuration-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="_8-4-3-定义一个实体类映射配置信息"><a href="#_8-4-3-定义一个实体类映射配置信息" class="header-anchor">#</a> 8.4.3 定义一个实体类映射配置信息</h4> <p>@ConfigurationProperties(prefix = &quot;demo&quot;) 它可以把相同前缀的配置信息通过配置项名称映射成实体类，比如我们这里指定 prefix = &quot;demo&quot; 这样，我们就能将以demo为前缀的配置项拿到了。</p> <blockquote><p>ps：其实这个注解很强大，它不但能映射成String或基本类型的变量。还可以映射为List，Map等数据结构。</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>starter<span class="token punctuation">.</span>properties</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">ConfigurationProperties</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoProperties</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> sayWhat<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> toWho<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getSayWhat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> sayWhat<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSayWhat</span><span class="token punctuation">(</span><span class="token class-name">String</span> sayWhat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sayWhat <span class="token operator">=</span> sayWhat<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getToWho</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> toWho<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setToWho</span><span class="token punctuation">(</span><span class="token class-name">String</span> toWho<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>toWho <span class="token operator">=</span> toWho<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_8-4-4-定义一个service"><a href="#_8-4-4-定义一个service" class="header-anchor">#</a> 8.4.4 定义一个Service</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>starter<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> sayWhat<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> toWho<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">DemoService</span><span class="token punctuation">(</span><span class="token class-name">String</span> sayWhat<span class="token punctuation">,</span> <span class="token class-name">String</span> toWho<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sayWhat <span class="token operator">=</span> sayWhat<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>toWho <span class="token operator">=</span> toWho<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sayWhat <span class="token operator">+</span> <span class="token string">&quot;!  &quot;</span> <span class="token operator">+</span> toWho<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_8-4-5-定义一个配置类"><a href="#_8-4-5-定义一个配置类" class="header-anchor">#</a> 8.4.5 定义一个配置类</h4> <p>这里，我们将DemoService类定义为一个Bean，交给Ioc容器。</p> <ul><li><p>@Configuration 注解就不多说了。</p></li> <li><p>@EnableConfigurationProperties 注解。</p> <p>该注解是用来开启对3步骤中 @ConfigurationProperties 注解配置Bean的支持。也就是@EnableConfigurationProperties注解告诉Spring Boot 能支持@ConfigurationProperties。</p> <p>当然了，也可以在 @ConfigurationProperties 注解的类上添加 @Configuration 或者 @Component 注解</p></li> <li><p>@ConditionalOnProperty 注解控制 @Configuration 是否生效。简单来说也就是我们可以通过在yml配置文件中控制 @Configuration 注解的配置类是否生效。</p></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>starter<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>starter<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">DemoProperties</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>starter<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">DemoService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">.</span></span><span class="token class-name">ConditionalOnProperty</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">EnableConfigurationProperties</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">DemoProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnProperty</span><span class="token punctuation">(</span>
        prefix <span class="token operator">=</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>
        name <span class="token operator">=</span> <span class="token string">&quot;isopen&quot;</span><span class="token punctuation">,</span>
        havingValue <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">DemoProperties</span> demoProperties<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DemoService</span> <span class="token function">demoService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DemoService</span><span class="token punctuation">(</span>demoProperties<span class="token punctuation">.</span><span class="token function">getSayWhat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> demoProperties<span class="token punctuation">.</span><span class="token function">getToWho</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_8-4-6-创建spring-factories"><a href="#_8-4-6-创建spring-factories" class="header-anchor">#</a> 8.4.6 创建spring.factories</h4> <p>如图，新建META-INF文件夹，然后创建spring.factories文件，</p> <p><img src="data:image/png;base64,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" alt="img"></p> <p>在该文件中加入如下配置，该配置指定上步骤中定义的配置类为自动装配的配置。</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span><span class="token punctuation">=</span><span class="token attr-value">com.demo.starter.config.DemoConfig</span>
</code></pre></div><h4 id="_8-4-7-测试"><a href="#_8-4-7-测试" class="header-anchor">#</a> 8.4.7 测试</h4> <p>在demo-spring-boot-starter工程中执行mvn clean install 一个自定义的starter新鲜出炉。</p> <p>新建测试工程</p> <p>引入starter依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>demo-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.0.1-RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>配置文件 application.yml</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">demo</span><span class="token punctuation">:</span>
	isopen=true
	say<span class="token punctuation">-</span>what=hello
	to<span class="token punctuation">-</span>who=shf
</code></pre></div><p>然后写个测试类。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>test<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>starter<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">DemoService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">DemoService</span> demoService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/say&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">sayWhat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> demoService<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>浏览器</p> <p><img src="data:image/png;base64,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" alt="img"></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/study/javaji-shu-zhan/spring.html" class="prev">
        Spring注解开发
      </a></span> <span class="next"><a href="/study/javaji-shu-zhan/spring-security-oauth2.html">
        Spring Security OAuth2
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/study/assets/js/app.dc60e210.js" defer></script><script src="/study/assets/js/6.fceef279.js" defer></script><script src="/study/assets/js/7.e9fa99bf.js" defer></script>
  </body>
</html>
